"use strict";(self["webpackChunkimvue"]=self["webpackChunkimvue"]||[]).push([[912],{5410:function(e,r,a){a(4114);var s=a(8355),o=a(1219),t=a(5548),l=a(4985);const u=s.A.create({baseURL:l.b,timeout:1e4});u.interceptors.request.use((e=>{if(e.headers.Authorization=`Bearer ${localStorage.getItem("token")}`,!e.url.includes("upload")&&e.data){const r=t.Ln.encrypt(JSON.stringify(e.data));e.data={data:r.cipherText,position:r.position,mac:"",length:0}}return e}),(e=>(console.log("request error",e),Promise.reject(e)))),u.interceptors.response.use((e=>{if(e.data.data){const a=e.data.en_data.data,s=e.data.en_data.position;let l="";try{l=t.VJ.decrypt(a,s)}catch(r){o.nk.error("解密失败，请重新登录获取密钥"),localStorage.clear(),(void 0).$router.push("/login")}e.data.data=JSON.parse(l)}return e}),(e=>(console.log("error",e),401===e.response.status&&(o.nk.error("登录无效或过期，请重新登录"),localStorage.clear(),window.location.href="/login"),Promise.reject(e)))),r.A=u},188:function(e,r,a){a.r(r),a.d(r,{default:function(){return m}});var s=a(6768);const o=e=>((0,s.Qi)("data-v-92f81536"),e=e(),(0,s.jt)(),e),t=o((()=>(0,s.Lk)("h2",null,"修改密码",-1)));function l(e,r,a,o,l,u){const d=(0,s.g2)("el-divider"),n=(0,s.g2)("el-input"),i=(0,s.g2)("el-form-item"),c=(0,s.g2)("el-button"),p=(0,s.g2)("el-form"),m=(0,s.g2)("el-card");return(0,s.uX)(),(0,s.Wv)(m,{class:"update-password-card"},{default:(0,s.k6)((()=>[t,(0,s.bF)(d),(0,s.bF)(p,{model:l.ruleForm,"status-icon":"",rules:l.rules,ref:"ruleForm","label-width":"120px",class:"demo-ruleForm"},{default:(0,s.k6)((()=>[(0,s.bF)(i,{label:"原密码",prop:"oriPass"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{type:"password",modelValue:l.ruleForm.oriPass,"onUpdate:modelValue":r[0]||(r[0]=e=>l.ruleForm.oriPass=e),autocomplete:"off","show-password":""},null,8,["modelValue"])])),_:1}),(0,s.bF)(i,{label:"密码",prop:"pass"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{type:"password",modelValue:l.ruleForm.pass,"onUpdate:modelValue":r[1]||(r[1]=e=>l.ruleForm.pass=e),autocomplete:"off","show-password":""},null,8,["modelValue"])])),_:1}),(0,s.bF)(i,{label:"确认密码",prop:"checkPass"},{default:(0,s.k6)((()=>[(0,s.bF)(n,{type:"password",modelValue:l.ruleForm.checkPass,"onUpdate:modelValue":r[2]||(r[2]=e=>l.ruleForm.checkPass=e),autocomplete:"off","show-password":""},null,8,["modelValue"])])),_:1}),(0,s.bF)(i,null,{default:(0,s.k6)((()=>[(0,s.bF)(c,{type:"primary",onClick:r[3]||(r[3]=e=>u.submitForm("ruleForm"))},{default:(0,s.k6)((()=>[(0,s.eW)("提交")])),_:1}),(0,s.bF)(c,{onClick:r[4]||(r[4]=e=>u.resetForm("ruleForm"))},{default:(0,s.k6)((()=>[(0,s.eW)("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})}a(4114);var u=a(5410),d=a(8165),n=a(1219),i={name:"UpdatePassword",components:{ElDivider:d.fR},data(){return{ruleForm:{oriPass:"",pass:"",checkPass:""},rules:{oriPass:[{validator:this.validateOriPass,trigger:"blur"}],pass:[{validator:this.validatePass,trigger:"blur"}],checkPass:[{validator:this.validateCheckPass,trigger:"blur"}]}}},methods:{validateOriPass(e,r){return new Promise(((e,a)=>{""===r?a(new Error("请输入原密码")):e()}))},validatePass(e,r){return new Promise(((e,a)=>{""===r?a(new Error("请输入密码")):e()}))},validateCheckPass(e,r){return new Promise(((e,a)=>{""===r?a(new Error("请再次输入密码")):r!==this.ruleForm.pass?a(new Error("两次输入密码不一致!")):e()}))},submitForm(e){this.$refs[e].validate().then((e=>{e?u.A.post("/api/user/update_password",{username:JSON.parse(localStorage.getItem("user")),old_password:this.ruleForm.oriPass,new_password:this.ruleForm.pass}).then((e=>{0===e.data.code?(n.nk.success("修改密码成功"),localStorage.removeItem("token"),this.$router.push("/login")):n.nk.error(e.data.msg)})).catch((e=>{n.nk.error("修改密码失败，连接服务器错误")})):n.nk.error("请检查输入是否正确")})).catch((e=>{n.nk.error(e.checkPass[0].message||"验证过程中出错")}))},resetForm(e){this.$refs[e].resetFields()},login(){this.$router.push("/login")}}},c=a(1241);const p=(0,c.A)(i,[["render",l],["__scopeId","data-v-92f81536"]]);var m=p}}]);
//# sourceMappingURL=contacts.05ba26f7.js.map